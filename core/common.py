import random
import re
import telebot
from telebot import types
from collections import defaultdict
import threading
import os
from dotenv import load_dotenv  # for parsing .env file


MAX_FILE_SIZE = 2 * 1024 * 1024 # 2 MB
EXPECTED_FORMATS = [".jpg", ".png", ".jpeg", ".webp"]
MAX_TAG_LENGTH = 30
MAX_INLINE_COLS = 3 # max count of columns in inline keyboard
MAX_INLINE_ROWS = 2 # max count of rows in inline keyboard

# once initialize keyboard as global scoped
markup = types.ReplyKeyboardMarkup(resize_keyboard=True)

MAKE_COLLAGE = "–°–æ—Å—Ç–∞–≤–∏—Ç—å –∫–æ–ª–ª–∞–∂"
LOAD_IMAGE = "–ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ"
START = "start"
COMMANDS = [MAKE_COLLAGE, LOAD_IMAGE, START]

get_collage_action = types.KeyboardButton(MAKE_COLLAGE)
load_image_action = types.KeyboardButton(LOAD_IMAGE)

markup.add(get_collage_action, load_image_action)

# Timer for bulk load images
album_timers = defaultdict(threading.Timer)
album_lock = threading.Lock()
AWAITING_FOR_LOAD_IMAGE = "–ñ–¥—É –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è load_image"

load_dotenv('./config.env')
BOT_API_KEY = os.getenv('BOT_API_KEY')
MEDIA_ROOT = os.getenv('MEDIA_ROOT')


STATES = {
    AWAITING_FOR_LOAD_IMAGE: False
}

cached_messages = defaultdict(list)

HELLO_MSG = r"""                 
<b><i>–î–∞ –∑–¥—Ä–∞–≤—Å—Ç–≤—É–µ—Ç, –≤–∞—à–µ –í–µ–ª–∏—á–µ—Å—Ç–≤–æ!</i></b>                                                                                  

–Ø - —Ä—ã—Ü–∞—Ä—å <b>CollageBot</b>, —á—Ç–æ –±—ã–ª –ø—Ä–∏–∑–≤–∞–Ω –æ—Ö—Ä–∞–Ω—è—Ç—å —Ñ–æ—Ç–æ—Ä–∞—Ñ–∏–∏ –º–æ–∏—Ö —Å—É–∑–µ—Ä–µ–Ω–æ–≤ –∏ –¥–∞–≤–∞—Ç—å –∫ –Ω–∏–º –æ—Ç—Ä—ã—Ç—ã–π –¥–æ—Å—Ç—É–ø. 

 ‚öîÔ∏è –í–æ—Ç –ø–æ–ø–æ–¥—Ä–æ–±–Ω–µ–µ –æ –º–æ–∏—Ö —Ñ—É–Ω–∫—Ü–∏—è—Ö:

üó° <code>\load_image</code> ‚Äì —Å –ø–æ–º–æ—â—å—é —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã—Ö –≥–æ–ª—É–±–µ–π, –¥–µ–ª–∞—é –≤–∞—à–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–æ—Å—Ç–æ—è–Ω–∏–µ–º –¥–ª—è –∂–∏—Ç–µ–ª–µ–π –≤—Å–µ–≥–æ –∫–æ—Ä–æ–ª–µ–≤—Å—Ç–≤–∞.

üó° <code>\get_collage</code> ‚Äì —Å–æ–∑–¥–∞—é –∫–æ–ª–ª–∞–∂ –ø–æ –≤–∞—à–∏–º –∑–∞–ø—Ä–æ—Å–∞–º, –∏—â–∞ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –≤ –≤–µ–ª–∏–∫–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–µ "–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö".
                     """

TAGS_PLS_MSG = r"""
<b><i>–í–∞—à–µ —Å–∏—è—Ç–µ–ª—å—Å—Ç–≤–æ, –æ–Ω–æ –ø—Ä–µ–∫—Ä–∞—Å–Ω–æ!</i></b>

–¢–µ–ø–µ—Ä—å, –ø—Ä–∏—à–ª–∞ –ø–æ—Ä–∞ –≤—ã–±—Ä–∞—Ç—å –∫–∞–∫–∏–µ —Ç–µ–≥–∏ –±—É–¥—É—Ç –∑–∞—â–∏—Ç–Ω–∏–∫–∞–º–∏, —á—Ç–æ–±—ã –≤–∞—à–µ –∑–∞–º–µ—á–∞—Ç–µ–ª—å–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–µ –∑–∞—Ç–µ—Ä—è–ª–æ—Å—å!

üìñ–í–æ—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—é —Ç–µ–≥–æ–≤:

1. <b>–¢–µ–≥–∏ –ø–∏—à—É—Ç—Å—è —Å —Å–∏–º–≤–æ–ª–æ–º</b> "<b>#</b>", —á—Ç–æ–±—ã –Ω–µ —É–±–µ–∂–∞–ª–∏üëÄ (–ù–∞–ø—Ä–∏–º–µ—Ä: #–∫—Ä–∞—Å–æ—Ç–∞).

2. <b>–ï—Å–ª–∏ –≤ –æ–¥–Ω–æ–º —Ç–µ–≥–µ —Ö–æ—Ç–∏—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–ª–æ–≤, —Ç–æ —Å–º–µ–ª–æ –≤–ø–µ—Ä—ë–¥</b>‚ñ∂Ô∏è (–ù–∞–ø—Ä–∏–º–µ—Ä: #–≥–æ—Ä–¥–æ—Å—Ç—å–∏–ø—Ä–µ–¥—É–±–µ–∂–¥–µ–Ω–∏–µ)

3.  <b>–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –Ω–∞–ø–∏—Å–∞—Ç—å –±–æ–ª—å—à–µ –æ–¥–Ω–æ–≥–æ —Ç–µ–≥–∞, —Ç–æ —Ç–æ–≥–¥–∞ –ø–∏—à–∏—Ç–µ –∏—Ö —á–µ—Ä–µ–∑ –ø—Ä–æ–±–µ–ª</b>, —è –±–æ—é—Å—å –∫–∞–∫ –∏–º –Ω–µ –±—ã–ª–æ —Ç–µ—Å–Ω–æüë¨ (–ù–∞–ø—Ä–∏–º–µ—Ä: #–≥–æ—Ä–¥–æ—Å—Ç—å–∏–ø—Ä–µ–¥—É–±–µ–∂–¥–µ–Ω–∏–µ #–∫—Ä–∞—Å–æ—Ç–∞ #–¥–æ—Å—Ç–æ–∏–Ω—Å—Ç–≤–æ)
"""

LOAD_IMAGE_MANUAL_MSG = rf"""
                <b><i>–í–∞—à–µ –ø—Ä–µ–≤–æ—Å—Ö–æ–¥–∏—Ç–µ–ª—å—Å—Ç–≤–æ, —Å–ª—É—à–∞—é—Å—å –∏ –ø–æ–≤–∏–Ω—É—é—Å—å!</i></b>

–í—ã–±–µ—Ä–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –∂–µ–ª–∞–µ—Ç–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ —Å–æ–∫—Ä–æ–≤–∏—â–Ω–∏—Ü—É.

üëë–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∫–æ—Ä–æ–ª–µ–≤—Å–∫–æ–≥–æ –¥–µ–∫—Ä–µ—Ç–∞ –¥–ª—è —Ñ–∞–π–ª–æ–≤:                                                          

1. <b>–§–æ—Ä–º–∞—Ç</b>: {", ".join(EXPECTED_FORMATS)} (–≤ –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ —Å–≤–∏—Ç–∫–∏ —Å–≥–Ω–∏—é—Çüìú)

2. <b>–¶–µ–Ω–∑—É—Ä–∞</b>: –Ω–µ 18+ –∫–æ–Ω—Ç–µ–Ω—Ç (üò≠üò≠üò≠)

3. <b>–†–∞–∑–º–µ—Ä</b>: –Ω–µ –±–æ–ª–µ–µ 2MB (–∏–Ω–∞—á–µ –≥–æ–ª—É–±–∏ –Ω–µ –¥–æ–ª–µ—Ç—è—Çüïä)
 
4. <b>–í–∏–¥</b>: –æ—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–∞–π–ª–∞ –≤ —Å–∂–∞—Ç–æ–º –≤–∏–¥–µ (–Ω–µ —Ö–æ—á—É –º–∞—Ä–∞—Ç—å –≤–∞—à–∏ –≤–µ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –¥–ª–∞–Ω–∏ü•∞)
                """

UNEXPECTED_FILE_FORMAT_MSG = r"""
–í–∞—à–µ –≤–µ–ª–∏—á–µ—Å—Ç–≤–æ! ‚öîÔ∏èüìú

–ú–æ–∏ —Å–æ–∫–æ–ª—å–Ω–∏—á—å–∏ –¥–æ–ª–æ–∂–∏–ª–∏, —á—Ç–æ –≤—ã –æ—Ç–ø—Ä–∞–≤–∏–ª–∏ <b>–Ω–µ—Å–∂–∞—Ç—ã–µ —Å–≤–∏—Ç–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π</b>! 

–î–∞–±—ã —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤–∞—à–∏ –∫–æ—Ä–æ–ª–µ–≤—Å–∫–∏–µ –¥–ª–∞–Ω–∏ —á–∏—Å—Ç—ã–º–∏, –∞ –Ω–∞—à–∏ –≥–æ–ª—É–±—è—Ç–Ω–∏ - –≤ –ø–æ—Ä—è–¥–∫–µ, –ø—Ä–æ—à—É –≤–∞—Å:

1. –û—Ç–∫—Ä—ã—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ <b>–∫–æ—Ä–æ–ª–µ–≤—Å–∫–æ–º –∞–ª—å–±–æ–º–µ</b> (–≥–∞–ª–µ—Ä–µ–µ)
2. –í—ã–±—Ä–∞—Ç—å –æ–ø—Ü–∏—é <b>"–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–∞–∫ —Ñ–æ—Ç–æ"</b> (–Ω–µ –∫–∞–∫ —Ñ–∞–π–ª!)

–¢–∞–∫ –≤–∞—à–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –±—ã—Å—Ç—Ä–µ–µ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç –Ω–∞—à–µ–π —Å–æ–∫—Ä–æ–≤–∏—â–Ω–∏—Ü—ã, –Ω–µ –æ—Ç—è–≥–æ—â–∞—è –∫—Ä—ã–ª—å—è –Ω–∞—à–∏—Ö –≤–µ—Ä–Ω—ã—Ö –≥–æ–ª—É–±–µ–π!
"""

UNEXPECTED_MSG = r"""
–í–∞—à–µ –≤–µ–ª–∏—á–µ—Å—Ç–≤–æ, –≤–∞—à–∏ –∏–∑—Ä–µ—á–µ–Ω–∏—è —Å–ª–∏—à–∫–æ–º —Å–ª–æ–∂–Ω—ã –¥–ª—è –≤–∞—à–µ–≥–æ –ø–æ–∫–æ—Ä–Ω–æ–≥–æ —Å–ª—É–≥–∏, —á—Ç–æ–±—ã –æ–Ω —á—Ç–æ-—Ç–æ —Å–º–æ–≥ –ø–æ–Ω—è—Ç—å.üòî
                            
<b>–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏.</b>
"""

SUCCESS_MSG = r"""‚úÖ<b>–í—Å—ë –ø—Ä–æ—à–ª–æ —É—Å–ø–µ—à–Ω–æ, –≤–∞—à–µ –≤–µ–ª–∏—á–µ—Å—Ç–≤–æ!
–£–≤–µ—Ä–µ–Ω –≤–∞—à–µ–º—É –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é —Å—É–ª–∏—Ç –±–æ–ª—å—à–∞—è —Å–ª–∞–≤–∞.</b>üèÜ
"""

USER_MISTAKE_GETUP_MSGS = [
r"""‚ùå<b>–û—à–∏–±–∫–∞.</b>

–í–∞—à–µ –ø—Ä–µ–≤–æ—Å—Ö–æ–¥–∏—Ç–µ–ª—å—Å—Ç–≤–æ, –æ—à–∏–±–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ç–æ—Ç, –∫—Ç–æ –≥–æ—Ä–∏—Ç —Ä–≤–µ–Ω–∏–µ–º, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ, —Å–ª–µ–¥–æ–≤–∞–ª–∏ –ª–∏ –≤—ã –¥–µ–∫—Ä–µ—Ç—É.
""",

r"""‚ùå<b>–û—à–∏–±–∫–∞.</b>

–ú–æ–π –∫–æ—Ä–æ–ª—å, –Ω–∞—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å - –º–∞—Ç—å —É–¥–∞—á–∏, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞, —Å–ª–µ–¥—É—è –¥–µ–∫—Ä–µ—Ç—É.
""",

r"""‚ùå<b>–û—à–∏–±–∫–∞.</b>

–í–∞—à–µ –≤–µ–ª–∏—á–µ—Å—Ç–≤–æ, –ò–µ—Ä—É—Å–∞–ª–∏–º –Ω–µ –∑–∞ 1 –¥–µ–Ω—å –∑–∞—Ö–≤–∞—Ç–∏–ª–∏ –∏ –Ω–µ —Ä–∞–∑, –Ω–µ –æ—Ç—á–∞–∏–≤–∞–π—Ç–µ—Å—å, –¥–µ–∫—Ä–µ—Ç —É–∫–∞–∂–µ—Ç –≤–∞–º –ø—É—Ç—å.
""",

r"""‚ùå<b>–û—à–∏–±–∫–∞.</b>

–í–∞—à–µ –≤–µ–ª–∏—á–µ—Å—Ç–≤–æ, —è —Å –≤–∞–º–∏ –¥–æ –∫–æ–Ω—Ü–∞, –Ω–µ –æ–ø—É—Å–∫–∞–π—Ç–µ —Ä—É–∫, –¥–µ–∫—Ä–µ—Ç —Å–æ–∑–¥–∞–Ω, —á—Ç–æ–±—ã –Ω–µ –æ—à–∏–±–∞—Ç—å—Å—è.
"""
]

USER_MISTAKE_TAGS_MSGS = [
r"""‚ùå<b>–û—à–∏–±–∫–∞.</b>

–í–∞—à–µ –ø—Ä–µ–≤–æ—Å—Ö–æ–¥–∏—Ç–µ–ª—å—Å—Ç–≤–æ, –æ—à–∏–±–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ç–æ—Ç, –∫—Ç–æ –≥–æ—Ä–∏—Ç —Ä–≤–µ–Ω–∏–µ–º, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ, —Å–ª–µ–¥–æ–≤–∞–ª–∏ –ª–∏ –≤—ã –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏.
""",

r"""‚ùå<b>–û—à–∏–±–∫–∞.</b>

–ú–æ–π –∫–æ—Ä–æ–ª—å, –Ω–∞—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å - –º–∞—Ç—å —É–¥–∞—á–∏, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞, —Å–ª–µ–¥—É—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏.
""",

r"""‚ùå<b>–û—à–∏–±–∫–∞.</b>

–í–∞—à–µ –≤–µ–ª–∏—á–µ—Å—Ç–≤–æ, –ò–µ—Ä—É—Å–∞–ª–∏–º –Ω–µ –∑–∞ 1 –¥–µ–Ω—å –∑–∞—Ö–≤–∞—Ç–∏–ª–∏ –∏ –Ω–µ —Ä–∞–∑, –Ω–µ –æ—Ç—á–∞–∏–≤–∞–π—Ç–µ—Å—å, –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è —É–∫–∞–∂–µ—Ç –≤–∞–º –ø—É—Ç—å.
""",

r"""‚ùå<b>–û—à–∏–±–∫–∞.</b>

–í–∞—à–µ –≤–µ–ª–∏—á–µ—Å—Ç–≤–æ, —è —Å –≤–∞–º–∏ –¥–æ –∫–æ–Ω—Ü–∞, –Ω–µ –æ–ø—É—Å–∫–∞–π—Ç–µ —Ä—É–∫, –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞, —á—Ç–æ–±—ã –Ω–µ –æ—à–∏–±–∞—Ç—å—Å—è.
"""
]

UNEXPECTED_IMG_MSG = r"""
–í–∞—à–µ –ø—Ä–µ–≤–æ—Å—Ö–æ–¥–∏—Ç–µ–ª—å—Å—Ç–≤–æ, –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–π—Ç–µ –±–µ–¥–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –±–µ–∑ –æ—Ö—Ä–∞–Ω—ã –≤ –≤–∏–¥–µ —Ç–µ–≥–æ–≤, –æ–Ω–æ –∂–µ —É–º—Ä—ë—Ç.
                            
<b>–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏.</b>
"""

LARGE_FILE_MSG = r"""
–û, –≤–∞—à–µ –≤–µ–ª–∏—á–µ—Å—Ç–≤–æ!

–ü–æ–∂–∞–ª–µ–π—Ç–µ –≥–æ–ª—É–±–µ–π, –æ–Ω–∏ –Ω–µ –¥–æ–ª–µ—Ç—è—Ç –∏ –ø–æ–≥–∏–±–Ω—É—Ç, –≤–µ–¥—å —É –≤–∞—Å <b>—Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π —Å–≤–∏—Ç–æ–∫</b>üòâ (<i>–¥–æ–∫—É–º–µ–Ω—Ç</i>).
"""

UNEXPECTED_IMG_FORMAT_MSG = r"""
–û, –≤–∞—à–µ –≤–µ–ª–∏—á–µ—Å—Ç–≤–æ!

–ü–æ–∂–∞–ª–µ–π—Ç–µ –ø–µ—Ä–≥–∞–º–µ–Ω—Ç, –æ–Ω —Ç–∞–∫ —Å–≥–Ω–∏—ë—Ç, –ø–æ—Ç–æ–º—É —á—Ç–æ <b>–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞</b>üßê.
"""

LOAD_IMG_FAIL_MSG = r"""
–û, –≤–∞—à–µ –≤–µ–ª–∏—á–µ—Å—Ç–≤–æ!

–°–º–∏–ª—É–π—Ç–µ—Å—å –Ω–∞–¥ –≤–∞—à–∏–º–∏ –ø—Ä–µ–∑—Ä–µ–Ω–Ω—ã–º–∏ –ø–æ–¥–¥–∞–Ω–Ω—ã–º–∏, –≤–∞—à–∏ –≤–æ–∏–Ω—ã-—Ç–µ–≥–∏ –Ω–µ —Å–º–æ–≥–ª–∏ –∑–∞—â–∏—Ç–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –∏ —Ç–µ–ø–µ—Ä—å –æ–Ω–æ –≤ —Ä–∞–±—Å—Ç–≤–µ, —è –æ–±–ª–∞–∂–∞–ª—Å—èü•∫ (<i>–ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –≤ –∑–∞–≥—Ä—É–∑–∫–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–ª–∏ —Ç–µ–≥–æ–≤</i>).

"""

LOSED_FILE_ID_MSG = r"""
–í–∞—à–µ –ø—Ä–µ–≤–æ—Å—Ö–æ–¥–∏—Ç–µ–ª—å—Å—Ç–≤–æ, —Å–º–µ—é –æ–≥–æ—Ä—á–∏—Ç—å, —á—Ç–æ –∂–µ–ª–∞–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–µ –±—ã–ª–æ –Ω–∞–π–¥–µ–Ω–æ, —Ç–∞–∫ –∫–∞–∫ –≤ –≤–µ–ª–∏–∫–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–µ <b>–Ω–µ –Ω–∞—à–ª–æ—Å—å –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –ø–æ –≤–∞—à–µ–º—É –ø—Ä–∏–∫–∞–∑—É</b>.üìö

"""

UNDEFINED_FAIL_MSG = r"""
–í–∞—à–µ –ø—Ä–µ–≤–æ—Å—Ö–æ–¥–∏—Ç–µ–ª—å—Å—Ç–≤–æ, –ø—Ä–∏–º–∏—Ç–µ –º–æ–∏ –∏–∑–≤–∏–Ω–µ–Ω–∏—è, –≤–µ–ª–∏–∫–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ —Å–ª–∏—à–∫–æ–º –≤–µ–ª–∏–∫–∞ –∏ <b>–≤–∞—à–µ –ø–æ—Ä—É—á–µ–Ω–∏–µ –Ω–µ —É–¥–∞–ª–æ—Å—å –∏—Å–ø–æ–ª–Ω–∏—Ç—å</b>ü§° (<i>–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞</i>).

"""

SAME_TAGS_ERROR_MSG = r"""
–ú–æ–π –∫–æ—Ä–æ–ª—å, —è –Ω–µ –ø–æ–Ω—è–ª —Å–º—ã—Å–ª –≤–∞—à–∏—Ö —Å—Ç—Ä–æ–∫, –º–æ–∂–µ—Ç–µ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞? (<i>—Ç–µ–≥–∏ –ø–æ –≤–∞—à–µ–º—É –∑–∞–ø—Ä–æ—Å—É –Ω–µ –±—ã–ª–∏ –Ω–∞–π–¥–µ–Ω—ã</i>)

"""

EMPTY_TAG_ERROR_MSG = r"""
–û, –Ω–µ—Ç, –≤–∞—à–µ –≤–µ–ª–∏—á–µ—Å—Ç–≤–æ!

–í—ã –∂–µ –Ω–µ –ø–æ—Å–ª–∞–ª–∏ –≤–æ–∏–Ω–æ–≤-—Ç–µ–≥–æ–≤ —Å –≤–∞—à–∏–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º <b> –∫–∞–∫ –±—ã —Å –Ω–∏–º, —á—Ç–æ –Ω–µ —Å–ª—É—á–∏–ª–æ—Å—å</b>üòà.
"""

NO_IMAGES_FOUND_MSG = r"""
–í–∞—à–µ –≤–µ–ª–∏—á–µ—Å—Ç–≤–æ! ‚öîÔ∏èüìú

–° –≤–µ–ª–∏–∫–æ–π –ø–µ—á–∞–ª—å—é –¥–æ–∫–ª–∞–¥—ã–≤–∞—é, —á—Ç–æ –≤ –∫–æ—Ä–æ–ª–µ–≤—Å–∫–æ–π —Å–æ–∫—Ä–æ–≤–∏—â–Ω–∏—Ü–µ <b>–Ω–µ –Ω–∞—à–ª–æ—Å—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π</b>, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –≤–∞—à–µ–º—É —É–∫–∞–∑—É.

–ß—Ç–æ –¥–µ–ª–∞—Ç—å:
‚Ä¢ –ü–æ–ø—Ä–æ–±—É–π—Ç–µ <b>–±–æ–ª–µ–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—ë–Ω–Ω—ã–µ —Ç–µ–≥–∏</b> –∏–∑ —Å–ø–∏—Å–∫–∞ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö
‚Ä¢ <b>–ó–∞–≥—Ä—É–∑–∏—Ç–µ –ø–µ—Ä–≤—ã–º–∏</b> –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ —ç—Ç–æ–π —Ç–µ–º–µ
‚Ä¢ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ <b>–ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –Ω–∞–ø–∏—Å–∞–Ω–∏—è</b> —Ç–µ–≥–æ–≤

"""

LARGE_TAG_MSG = fr"""
–í–∞—à–µ –≤–µ–ª–∏—á–µ—Å—Ç–≤–æ, —ç—Ç–æ—Ç –≤–æ–∏–Ω-—Ç–µ–≥ —Å–ª–∏—à–∫–æ–º –æ–≥—Ä–æ–º–µ–Ω, <b> –∫–∞–∫ –±—ã —Å –≤–∞—à–∏–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º, —á—Ç–æ –Ω–µ —Å–ª—É—á–∏–ª–æ—Å—å</b>üòà (–º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ —Ç–µ–≥–∞ = {MAX_TAG_LENGTH}).

"""

GET_COLLAGE_MANUAL_MSG = r"""
<b><i>–í–∞—à–µ —Å–∏—è—Ç–µ–ª—å—Å—Ç–≤–æ, —è —Å–µ–π—á–∞—Å –∂–µ –æ—Ç—Ä–∞–≤–ª—é—Å—å –Ω–∞ –ø–æ–∏—Å–∫–∏!</i></b>

–ù–æ –ø—Ä–µ–∂–¥–µ –≤—Å–µ–≥–æ, —Å–¥–µ–ª–∞–π—Ç–µ –≤—ã–±–æ—Ä:                                                    

<b>–í–≤–µ—Å—Ç–∏ –∑–∞–ø—Ä–æ—Å</b> - –∏–∑–¥–∞–π—Ç–µ –∫–æ—Ä–æ–ª–µ–≤—Å–∫–∏–π —É–∫–∞–∑üßë‚Äç‚öñÔ∏è

<i>–ü—Ä–æ—Å—Ç–æ –≤–≤–µ–¥–∏—Ç–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –æ–ø–∏—Å—ã–≤–∞–µ—Ç –≤–∞—à –±—É–¥—É—â–∏–π –∫–æ–ª–ª–∞–∂ (–Ω–∞–ø—Ä–∏–º–µ—Ä: –ª–µ—Ç–Ω–∏–π —Å–æ–ª–Ω–µ—á–Ω—ã–π –ø–ª—è–∂).</i>

<b><i>–ò–õ–ò</b></i>

<b>–í—ã–±—Ä–∞—Ç—å –∏–∑ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —Ç–µ–≥–æ–≤</b> - —É–∑–Ω–∞–π—Ç–µ –æ —á—ë–º —Ç–æ–ª–∫—É–µ—Ç —á–µ—Ä–Ω—åü¶ª

<i>–ü—Ä–æ—Å—Ç–æ –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –≤–∞–º –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ç–µ–≥–∏.</i>

"""
def user_mistake_msg() -> str:
    return random.choice(USER_MISTAKE_GETUP_MSGS)


def is_valid_tags(hashtags: list[str]) -> tuple[bool, list[str]]:
    errors = []
    res = True
    if not hashtags:
        errors.append(EMPTY_TAG_ERROR_MSG)
        res = False

    for tag in hashtags:
        if len(tag) > MAX_TAG_LENGTH:
            errors.append(LARGE_TAG_MSG)
            res = False

    return (res, errors)